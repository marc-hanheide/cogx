<!-- Inner build file for a module in DFKI "talking robots" APIs -->
<project name="belief-misc" default="compile" basedir=".">
  
	<!-- =================================================================== -->
     <!-- Add JAR files to classpath                                          -->
     <!-- =================================================================== -->
     <path id="build.classpath">
         <pathelement path="${ice.jar}"/>
         <pathelement path="${cast.jar}"/>
         <pathelement path="${antice.jar}"/>
         <pathelement path="${log4j.jar}"/>
     </path>

	
	<!-- =================================================================== -->
	<!-- Set up properties for process control                               -->
	<!-- =================================================================== -->
	 	
	<!-- Controls where the output goes -->
	<property name="output.dir" value="../../../../output/classes" />
	
	<!-- Controls what is compiled -->
	<property name="src.dir" value="." />
	
	<!-- <property name="generated.dir" -->
	<!--              value="${src.dir}/de/dfki/lt/tr/beliefs/slice"/> -->

	
	<!-- <property name="slice.dir" value="./src/slice" /> -->
	 
	<!-- <property name="test.dir" value="./test/java"/>  -->
	
	
	<!-- Includes the slice2java task from Ice. Requires ant-ice.jar to be in your classpath -->
	<taskdef name="slice2java" classname="Slice2JavaTask">
	</taskdef>

	<!-- Controls where the output of unit test goes -->  
	
	<property name="junit.data" value="reports/junit/data"/>
	<property name="junit.html" value="reports/junit/html"/>
	

	<!-- Controls where the output of the source documentation goes -->

	<property name="src.doc" value="../../doc/src"/>


	<!-- Controls where the JAR archive goes -->

	<property name="jar.dir" value="../../jar"/>

	<!-- =================================================================== -->
	<!-- Set up classpath for unit testing                                   -->
	<!-- =================================================================== -->
	 
	<!-- Use the main classpath as long as production and test code not separated -->
	<path id="build.classpath.test">
		<path refid="build.classpath"/> 
		<pathelement path="${output.dir}" />
	</path>
	
	
	
	<!-- =================================================================== -->
	<!-- Preparation                                                         -->
	<!-- =================================================================== -->
	<target name="prepare"  description="any project-specific init">
	  <mkdir dir="${output.dir}"/>
	</target>

	<!-- =================================================================== -->
	<!-- Expand libraries                                                    -->
	<!-- =================================================================== -->

    <target name="expandlibs" depends="prepare">
           <!-- <echo message="Expanding external libraries for the binder to output/classes"/> -->
           <!-- <unzip dest="${output.dir}" src="./lib/junit-4.4.jar"/> -->
    </target>


	<!-- =================================================================== -->
	<!-- Source generation                                                   -->
	<!-- =================================================== -->

	
	<target name="slice" description="generates source from slice">

	</target>

    <!-- =================================================================== -->
    <!-- slice file compilation                                              -->
    <!-- =================================================================== -->
    <target name="compile-slice" depends="slice" description="compiles autogenerated classes">
            <!-- <javac srcdir="${generated.dir}" destdir="${output.dir}" debug="${debug}" deprecation="${deprecation}" optimize="${optimize}" debuglevel="lines,vars,source"> -->
            <!--                <classpath refid="build.classpath"/> -->
            <!--                 </javac> -->
    </target>
	
	<!-- =================================================================== -->
	<!-- Basic compilation                                                   -->
	<!-- =================================================================== -->
	<target name="compile" depends="compile-java-production, compile-java-testing" 
		description="compiles the production- and unit test source code, and runs the unit-tests">
	</target>


    <target name="compile-java-production" depends="expandlibs,slice" 
    	description="compiles the production source code">
        <javac srcdir="${src.dir}" destdir="${output.dir}" debug="${debug}" deprecation="${deprecation}" excludes="eu/cogx/perceptmediator/attic/**"
        	optimize="${optimize}" debuglevel="lines,vars,source">
               <classpath refid="build.classpath"/>
        </javac>
    </target>

	<target name="compile-java-testing" depends="expandlibs,slice" description="compiles the unit test source code">
	        <!-- <javac srcdir="${test.dir}" destdir="${output.dir}" debug="${debug}" deprecation="${deprecation}"  -->
	        <!-- 	optimize="${optimize}" debuglevel="lines,vars,source"> -->
	        <!--        <classpath refid="build.classpath"/> -->
	        <!-- </javac> -->
	</target>

 

	<!-- =================================================================== -->
	<!-- JUnit4-based unit testing                                           -->
	<!-- =================================================================== -->
	
	<!-- <target name="test" depends="-test-run,-test-report"/> -->
		
	<!-- <target name="-test-run"> -->
	<!-- 	<mkdir dir="${junit.data}"/> -->
	<!-- 	<junit printsummary="yes" fork="true" haltonfailure="no"> -->
	<!-- 		<classpath> -->
	<!-- 			<path refid="build.classpath.test"/> -->
	<!-- 		</classpath> -->
	<!-- 		<formatter type="xml"/> -->
	<!-- 		<batchtest haltonfailure="no" todir="${junit.data}"> -->
	<!-- 			<fileset dir="test/java" includes="*/*/*/*/*/*/*Test.java"/> -->
	<!-- 		</batchtest> -->
	<!-- 	</junit> -->
	<!-- </target> -->
		
	<!-- <target name="-test-report" depends="-test-run"> -->
	<!-- 	<mkdir dir="${junit.html}"/> -->
	<!-- 	<junitreport todir="${junit.data}"> -->
	<!-- 		<fileset dir="${junit.data}" includes="TEST-*.xml"/> -->
	<!-- 		<report format="frames" todir="${junit.html}"/> -->
	<!-- 	</junitreport> -->
	<!-- </target> -->


	<!-- =================================================================== -->
	<!-- Javadoc                                                             -->
	<!-- =================================================================== -->

	<target name="doc" depends="-src-doc"/>

	<target name="-src-doc">
	  <javadoc
             destdir="${src.doc}"
             author="true"
             version="true"
             use="true"
             windowtitle="Belief API (release v0.3)">

	    <fileset dir="${src.dir}" defaultexcludes="yes">
	    </fileset>

	    <doctitle><![CDATA[<h1>Belief API (release v0.3)</h1>]]></doctitle>
	    <bottom><![CDATA[<i>Copyright &#169; 2010 DFKI GmbH. All Rights Reserved.</i>]]></bottom>
	  </javadoc>
        </target>

	<!-- =================================================================== -->
	<!-- JAR creation                                                        -->
	<!-- =================================================================== -->
	
	<target name="jar">
	  <jar destfile="${jar.dir}/belief-v03.jar"
	       basedir ="${output.dir}"
	       includes = "de/dfki/lt/tr/beliefs/*/*.class"
	       excludes = "de/dfki/lt/tr/beliefs/*/*Test.class"
          />
	</target>


	<!-- =================================================================== -->
	<!-- Clean                                                             -->
	<!-- =================================================================== -->
	

		<target name="clean">
		        <delete file="${src.dir}/.depend"/>
		        <delete dir="${generated.dir}"/>
		</target>


</project>
