\subsection{Qualitative Spatial Representation Extraction}

For each object that Dora detects we compute 8 spatial relations between that object and each of the objects adjacent to it; adjacency is determined using a voronoi diagram, as is standard in geometric reasoning \cite{Forbus/etal2003}. The model used to compute these relations was inspired by the literature on modeling the semantics of spatial terms, \cite{kelleher/costello:09,kelleher/vanGenabith:2006,regier/carlson:2001,gapp:1994}. The model accommodates both direction and distance as factors in the relative position of objects. 

The relations we compute between each given \emph{landmark} object and its adjacent neighbours are analogous to the cardinal and intermediate points on the compass when the compass is centered on the object. The canonical directions of these relations are defined using the following vectors: $<0,1>$, $<1,1>$, $<1,0>$, $<1,-1>$, $<0,-1>$, $<-1,-1>$, $<-1,0>$, $<-1,1>$; and, the predicates used to denote these relations are named accordingly, e.g. \textit{xOneYZero}, \textit{xOneYOne}, \textit{xZeroYOne}, \textit{xOneYMinOne}, etc.

We generate the strengths of these spatial relations as follows. First we compute the maximum distance between any two points in the room, this value is used to normalize the distances between objects in the room. Next, taking each object in turn to be the landmark, we translate the origin of the room to the landmark's centroid. This results in the coordinates of the all the other objects in the room being translated into a frame of reference whose origin is the centroid of the landmark.  We then compute the strength of each of the 8 spatial relations between the landmark and each of the objects adjacent to it by calculating: (a) the the distance between the landmark's centroid and the adjacent object's location, and (b) the inner angle between the vector from the origin (the landmark's centroid) to the neighbour's location and the direction vector of the relation. This angle is computed by taking the dot product of these two vectors. These two spatial components, distance and angular deviation, are then integrated to compute the strength of a given relationships as follows: 

\begin{equation}
strength = (innerAngle > 90^{\circ}? 0 : (1- \frac{innerAngle}{90^{\circ}}) * (1- \frac{distance}{maxDistance}))
\end{equation}

Figure \ref{fig:spr} provides a visualization of a spatial relationship across a region. These spatial relationships between adjacent objects provide the structure necessary for analogical processing.

\begin{figure}
\centerline{
\includegraphics[width=2in]{./images/spatialRelations/xOneYZeroWhite.png}
}
\caption{A visualisation of a the strength of a spatial relation across a region. In this figure the landmark is located at the center of the image and the direction vector used was $<1,0>$ (i.e. right of the landmark). The darker the pixel the stronger the spatial relation is deemed to be at that point.}
\label{fig:spr}
\end{figure}

