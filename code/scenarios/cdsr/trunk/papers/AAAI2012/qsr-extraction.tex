\subsection{Qualitative Spatial Representation Extraction}

For each object that Dora detects we compute the strengths of 8 spatial relations between that object and each of the objects adjacent to it; adjacency is determined using a voronoi diagram, as is standard in geometric reasoning \cite{Forbus/etal2003}. The relation's strength for a given pair of objects represents the applicability of the relation to the pair of objects ranging from 0 to 1 with 0 being unsuitable. The model used to compute these relations was inspired by the literature on modeling the semantics of spatial terms \cite{kelleher/costello:09,kelleher/vanGenabith:2006,regier/carlson:2001,gapp:1994}. The model accommodates both direction and distance as factors in the relative position of objects.

The relations we compute between each given \emph{landmark} object and its adjacent neighbours are analogous to the cardinal and intermediate points on the compass when the compass is centered on the object. The canonical directions of these relations are defined using the following vectors: $\langle0,1\rangle$, $\langle1,1\rangle$, $\langle1,0\rangle$, $\langle1,-1\rangle$, $\langle0,-1\rangle$, $\langle-1,-1\rangle$, $\langle-1,0\rangle$, $\langle-1,1\rangle$. The predicates used to denote these relations are named accordingly, e.g. \textit{xZeroYPlus}, \textit{xPlusYPlus}, \textit{xPlusYZero}, \textit{xPlusYMinus}, etc.

We generate the strengths of these spatial relations as follows. First we compute the maximum distance $d_{max}$ between any two points in the room, this value is used to normalize the distances between objects. Next, taking each object in turn to be the landmark, we translate the origin of the room to the landmark's centroid. This results in the coordinates of the all the other objects in the room being translated into a frame of reference whose origin is the centroid of the landmark.  We then compute the strength of each of the 8 spatial relations between the landmark and each of the objects adjacent to it by calculating: (a) the distance $d$ between the landmark's centroid and the adjacent object's location, and (b) the inner angle $\theta$ between the direction vector of the relation and the vector from the origin (the landmark's centroid) to the neighbour's location. These two spatial components are integrated to compute the strength $s$ of a given relationship using Equation~\ref{eq:spatial}. Figure \ref{fig:spr} provides a visualization of a spatial relationship across a region. 

\begin{equation}
s = \left\{
\begin{array}{l l}
\left(1- \frac{\theta}{90}\right) * \left(1- \frac{d}{d_{max}}\right) & \mathrm{if} \quad \theta \leq 90^{\circ}\\
0 & \mathrm{otherwise}
\end{array} \right.
%strength = (innerAngle > 90^{\circ}? 0 : \left(1- \frac{innerAngle}{90^{\circ}}\right) * \left(1- \frac{distance}{maxDistance}\right))
\label{eq:spatial}
\end{equation}


These spatial relationships between adjacent objects provide the structure necessary for analogical processing. Generating the relationships in this way (as opposed to, for example, simple coordinate-based thresholding) has the advantage that the presence and absence of relationships is represented on a continuous scale. This provides our representations with the flexibility necessary to manage the variation in perceptual information (i.e. the position of walls and objects) inevitable in human environments.

The last piece of symbolic representation extracted from the sensor data is grouping entities. We create a group entity anytime there is a set of adjacent objects of the same type. For example, a classroom would likely have a group entity created in which all of the students' desks were members.

\begin{figure}
\centerline{
\includegraphics[width=\columnwidth]{./images/spatialRelations/xZeroYOne.png}
}
\caption{A visualisation of a the strength of a spatial relation across a region. The landmark is the red square and the direction vector used was $\langle0,1\rangle$ (i.e. above of the landmark). The lighter the pixel the stronger the spatial relation is deemed to be at that point.}
\label{fig:spr}
\end{figure}


